package models

import "time"

// EnvironmentSummary holds vaulnerability scan summaries for components and jobs
type EnvironmentSummary struct {
	Name       string                        `json:"name"`
	Components ComponentVulnerabilitySummary `json:"components"`
	Jobs       ComponentVulnerabilitySummary `json:"jobs"`
}

// ComponentVulnerabilitySummary defines a map where key is component or job name and value is a summary of vulnerabilities
type ComponentVulnerabilitySummary map[string]ImageScanSummary

// VulnerabilitySeveritySummary defines a map where key is severity and value is number of vulnerabilities for severity
type VulnerabilitySeveritySummary map[string]int

type ImageScanSummary struct {
	Image                string                       `json:"image"`
	BaseImage            string                       `json:"baseImage"`
	LastScanned          time.Time                    `json:"lastScanned"`
	LastScanSuccess      bool                         `json:"scanSuccess"`
	VulnerabilitySummary VulnerabilitySeveritySummary `json:"vulnerabilitySummary"`
}
